# Примеры кода

## Сброс и очистка

### Сбросить все

```text
  Мок.Сервер("http://localhost", "1080").Сбросить();
```

## Сопоставление свойств запросов

### запрос совпадает по относительному пути

```text
  Мок.Когда(
      Мок.Запрос()
        .Путь("/some/path")
    ).Ответить(
      Мок.Ответ()
        .Тело("some_response_body")
    );
```

### запрос совпадает по методу через регулярные выражения

```text
  Мок.Когда(
      Мок.Запрос()
        .Метод("P.*{2,3}")
    ).Ответить(
      Мок.Ответ()
        .Тело("some_response_body")
    );
```

### запрос совпадает по неподходящему методу

```text
  Мок.Когда(
      Мок.Запрос()
        .Метод("!GET")
    ).Ответить(
      Мок.Ответ()
        .Тело("some_response_body")
    );
```

### запрос совпадает по параметрам запроса через регулярные выражения

```text
  Мок.Когда(
      Мок.Запрос()
        .Путь("/some/path")
        .ПараметрСтрокиЗапроса("cartId", "[A-Z0-9\\-]+")
        .ПараметрСтрокиЗапроса("anotherId", "[A-Z0-9\\-]+")
    ).Ответить(
      Мок.Ответ()
        .Тело("some_response_body")
    );
```

### запрос совпадает по заголовкам

```text
  Мок.Когда(
      Мок.Запрос()
        .Метод("GET")
        .Путь("/some/path")
        .Заголовки()
          .Заголовок("Accept", "application/json")
          .Заголовок("Accept-Encoding", "gzip, deflate, br")
    ).Ответить(
      Мок.Ответ()
        .Тело("some_response_body")
    );
```

## Проверка повторений запросов

### проверить, что запросы получены не менее двух раз

```text
  Мок.Когда(
      Мок.Запрос()
        .Путь("/some/path")
    ).Проверить(
      Мок.Повторений()
        .НеМенее(2)
    );
```

### проверить, что запросы получены не более двух раз

```text
  Мок.Когда(
      Мок.Запрос()
        .Путь("/some/path")
    ).Проверить(
      Мок.Повторений()
        .НеБолее(2)
    );
```

### проверить, что запросы получены точно два раза

```text
  Мок.Когда(
      Мок.Запрос()
        .Путь("/some/path")
    ).Проверить(
      Мок.Повторений()
        .Точно(2)
    );
```

### проверить, что запросы получены не менее двух раз в соответствии с OpenAPI

```text
  Мок.Когда(
      Мок.OpenAPI()
        .Источник("https://raw.githubusercontent.com/mock-server/mockserver/master/mockserver-integration-testing/src/main/resources/org/mockserver/mock/openapi_petstore_example.json")
    ).Проверить(
      Мок.Повторений()
        .НеМенее(2)
    );
```

### проверить, что запрос получен только один раз в соответствии с OpenAPI для некоторой операции

```text
  Мок.Когда(
      Мок.OpenAPI()
        .Источник("https://raw.githubusercontent.com/mock-server/mockserver/master/mockserver-integration-testing/src/main/resources/org/mockserver/mock/openapi_petstore_example.json")
        .Операция("listPets")
    ).Проверить(
      Мок.Повторений()
        .Однократно()
    );
```

### проверить, что запрос получен только один раз

```text
  Мок.Когда(
      Мок.Запрос()
        .Путь("/some/path")
    ).Проверить(
      Мок.Повторений()
        .Однократно()
    );
```

### проверить, что запросы получены в диапазоне между n и m раз

```text
  Мок.Когда(
      Мок.Запрос()
        .Путь("/some/path")
    ).Проверить(
      Мок.Повторений()
        .Между(2, 3)
    );
```

### проверить, что запросов не было

```text
  Мок.Когда(
      Мок.Запрос()
        .Путь("/some/path")
    ).Проверить(
      Мок.Повторений()
        .Точно(0)
    );
```
